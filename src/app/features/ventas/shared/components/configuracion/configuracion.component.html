<div
  class="config-zen-shell min-h-screen bg-surface-50 dark:bg-surface-950 transition-colors duration-300"
>
  <!-- üõ°Ô∏è HEADER PRINCIPAL EMPRESARIAL -->
  <div
    class="sticky top-0 z-50 bg-surface-0/80 dark:bg-surface-900/80 backdrop-blur-xl border-b border-surface-200 dark:border-surface-800 shadow-sm"
  >
    <div class="max-w-[1600px] mx-auto px-6 py-6">
      <div class="relative flex items-center justify-between">
        <!-- Blob Decorativo Org√°nico -->
        <div
          class="pointer-events-none absolute -top-20 -right-20 w-96 h-96 rounded-full bg-primary-200/30 dark:bg-primary-500/10 blur-[100px] animate-pulse-slow"
        ></div>

        <!-- Logo y T√≠tulo -->
        <div class="flex items-center gap-6 relative z-10">
          <div class="relative group cursor-default">
            <div
              class="w-16 h-16 bg-gradient-to-br from-surface-0 to-surface-50 dark:from-surface-800 dark:to-surface-900 rounded-[1.5rem] flex items-center justify-center shadow-lg border border-surface-200 dark:border-surface-700 group-hover:scale-105 transition-transform duration-500 ease-out"
            >
              <i
                class="pi pi-cog text-3xl text-primary-600 dark:text-primary-400"
              ></i>
            </div>
            <div
              class="absolute -bottom-1 -right-1 w-5 h-5 bg-emerald-500 rounded-full border-4 border-surface-0 dark:border-surface-950 shadow-sm"
            ></div>
          </div>
          <div>
            <h2
              class="text-3xl font-bold text-surface-900 dark:text-surface-0 tracking-tight leading-tight"
            >
              Configuraci√≥n
            </h2>

            <!-- Breadcrumbs Zen -->
            <div
              class="flex items-center gap-2 text-sm text-surface-500 dark:text-surface-400 mt-1"
            >
              <a
                class="hover:text-primary-600 dark:hover:text-primary-400 transition-colors cursor-pointer"
                (click)="irInicio()"
                >Inicio</a
              >
              <i class="pi pi-angle-right text-xs opacity-50"></i>
              <a
                class="hover:text-primary-600 dark:hover:text-primary-400 transition-colors cursor-pointer"
                (click)="irVentas()"
                >Ventas</a
              >
              <i class="pi pi-angle-right text-xs opacity-50"></i>
              <span class="font-medium text-surface-900 dark:text-surface-100"
                >Panel General</span
              >
            </div>
          </div>
        </div>

        <!-- Estado del Sistema -->
        <div
          class="hidden sm:flex items-center gap-4 px-5 py-3 bg-surface-0/50 dark:bg-surface-800/50 backdrop-blur-md rounded-2xl border border-surface-200/50 dark:border-surface-700/50 shadow-sm"
        >
          <div class="text-right">
            <div
              class="text-xs font-bold uppercase tracking-wider text-surface-400 dark:text-surface-500 mb-0.5"
            >
              Usuario Activo
            </div>
            <div
              class="font-semibold text-surface-700 dark:text-surface-200 text-sm"
            >
              {{ currentUser }}
            </div>
          </div>
          <div class="h-8 w-px bg-surface-200 dark:bg-surface-700"></div>
          <div class="relative">
            <div
              class="absolute inset-0 bg-emerald-500/20 blur-lg rounded-full"
            ></div>
            <div
              class="relative flex items-center justify-center w-10 h-10 bg-emerald-100 dark:bg-emerald-900/30 rounded-xl text-emerald-600 dark:text-emerald-400"
            >
              <i class="pi pi-shield text-lg"></i>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <main class="relative max-w-[1600px] mx-auto px-4 sm:px-6 py-8 space-y-8">
    <!-- METRICS GRID (Zen Cards) -->
    <section class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
      <!-- Card Usuarios -->
      <div
        class="group relative overflow-hidden bg-surface-0 dark:bg-surface-900 rounded-[2rem] p-6 border border-surface-200 dark:border-surface-800 shadow-sm hover:shadow-xl hover:-translate-y-1 transition-all duration-300"
      >
        <div
          class="absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity"
        >
          <i class="pi pi-users text-8xl text-primary-500"></i>
        </div>
        <div class="relative z-10">
          <p
            class="text- surface-500 dark:text-surface-400 text-sm font-medium mb-2"
          >
            Total Usuarios
          </p>
          <h3
            class="text-4xl font-bold text-surface-900 dark:text-surface-0 tracking-tight"
          >
            {{ usuarios.length }}
          </h3>
          <div
            class="mt-4 flex items-center gap-2 text-primary-600 dark:text-primary-400 text-sm font-medium"
          >
            <span
              class="bg-primary-50 dark:bg-primary-900/30 px-2.5 py-1 rounded-lg"
              >Activos</span
            >
          </div>
        </div>
      </div>

      <!-- Card Impresoras -->
      <div
        class="group relative overflow-hidden bg-surface-0 dark:bg-surface-900 rounded-[2rem] p-6 border border-surface-200 dark:border-surface-800 shadow-sm hover:shadow-xl hover:-translate-y-1 transition-all duration-300"
      >
        <div
          class="absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity"
        >
          <i class="pi pi-print text-8xl text-violet-500"></i>
        </div>
        <div class="relative z-10">
          <p
            class="text- surface-500 dark:text-surface-400 text-sm font-medium mb-2"
          >
            Impresoras
          </p>
          <h3
            class="text-4xl font-bold text-surface-900 dark:text-surface-0 tracking-tight"
          >
            {{ impresoras.length }}
          </h3>
          <div
            class="mt-4 flex items-center gap-2 text-violet-600 dark:text-violet-400 text-sm font-medium"
          >
            <span
              class="bg-violet-50 dark:bg-violet-900/30 px-2.5 py-1 rounded-lg"
              >Configuradas</span
            >
          </div>
        </div>
      </div>

      <!-- Card Fiscal -->
      <div
        class="group relative overflow-hidden bg-surface-0 dark:bg-surface-900 rounded-[2rem] p-6 border border-surface-200 dark:border-surface-800 shadow-sm hover:shadow-xl hover:-translate-y-1 transition-all duration-300"
      >
        <div
          class="absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity"
        >
          <i class="pi pi-file text-8xl text-amber-500"></i>
        </div>
        <div class="relative z-10">
          <p
            class="text- surface-500 dark:text-surface-400 text-sm font-medium mb-2"
          >
            Entorno Fiscal
          </p>
          <h3
            class="text-2xl font-bold text-surface-900 dark:text-surface-0 tracking-tight truncate"
          >
            {{ configFiscal.entornoSunat }}
          </h3>
          <div
            class="mt-4 flex items-center gap-2 text-amber-600 dark:text-amber-400 text-sm font-medium"
          >
            <span
              class="bg-amber-50 dark:bg-amber-900/30 px-2.5 py-1 rounded-lg"
              >SUNAT</span
            >
          </div>
        </div>
      </div>

      <!-- Card Backup -->
      <div
        class="group relative overflow-hidden bg-surface-0 dark:bg-surface-900 rounded-[2rem] p-6 border border-surface-200 dark:border-surface-800 shadow-sm hover:shadow-xl hover:-translate-y-1 transition-all duration-300"
      >
        <div
          class="absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity"
        >
          <i class="pi pi-database text-8xl text-emerald-500"></i>
        </div>
        <div class="relative z-10">
          <p
            class="text- surface-500 dark:text-surface-400 text-sm font-medium mb-2"
          >
            Respaldo
          </p>
          <h3
            class="text-2xl font-bold text-surface-900 dark:text-surface-0 tracking-tight"
          >
            {{ configBackup.frecuenciaBackup }}
          </h3>
          <div
            class="mt-4 flex items-center gap-2 text-emerald-600 dark:text-emerald-400 text-sm font-medium"
          >
            <span
              class="bg-emerald-50 dark:bg-emerald-900/30 px-2.5 py-1 rounded-lg"
              >Autom√°tico</span
            >
          </div>
        </div>
      </div>
    </section>

    <!-- ZEN TOOLBAR (Floating Navigation) -->
    <section class="sticky top-28 z-40 mx-auto max-w-4xl">
      <div
        class="bg-surface-900/5 dark:bg-surface-0/5 backdrop-blur-xl border border-surface-200/50 dark:border-surface-700/50 p-1.5 rounded-[2rem] shadow-lg flex justify-between items-center overflow-x-auto"
      >
        <div class="flex flex-nowrap gap-1 w-full">
          <button
            *ngFor="
              let tab of [
                { label: 'Usuarios', icon: 'pi pi-users' },
                { label: 'Negocio', icon: 'pi pi-building' },
                { label: 'Impresoras', icon: 'pi pi-print' },
                { label: 'Fiscal', icon: 'pi pi-calculator' },
                { label: 'Tema', icon: 'pi pi-palette' },
                { label: 'Backup', icon: 'pi pi-database' },
              ];
              let i = index
            "
            (click)="irASeccion(i)"
            class="flex-1 flex items-center justify-center gap-2 px-4 py-3 rounded-[1.5rem] text-sm font-bold transition-all duration-300 whitespace-nowrap"
            [ngClass]="
              seccionActiva === i
                ? 'bg-surface-0 dark:bg-surface-800 text-primary-600 dark:text-primary-400 shadow-md transform scale-100'
                : 'text-surface-600 dark:text-surface-400 hover:bg-surface-0/50 dark:hover:bg-surface-800/50 hover:text-surface-900 dark:hover:text-surface-200'
            "
          >
            <i [class]="tab.icon"></i>
            <span class="hidden sm:inline">{{ tab.label }}</span>
          </button>
        </div>
      </div>
    </section>

    <!-- CONTENEDOR PRINCIPAL DE SECCIONES (ngSwitch) -->
    <div class="mt-8 relative min-h-[500px]" [ngSwitch]="seccionActiva">
      <!-- 0. üë§ GESTI√ìN DE USUARIOS -->
      <section *ngSwitchCase="0" class="animate-fade-in-up">
        <div class="space-y-6">
          <!-- Toolbar Usuarios -->
          <div
            class="flex flex-col sm:flex-row justify-between items-center gap-4 p-6 bg-surface-0 dark:bg-surface-900 rounded-[2rem] shadow-sm border border-surface-200 dark:border-surface-800"
          >
            <div class="flex items-center gap-4">
              <div
                class="w-12 h-12 rounded-2xl bg-primary-50 dark:bg-primary-900/40 flex items-center justify-center text-primary-600 dark:text-primary-400"
              >
                <i class="pi pi-users text-xl"></i>
              </div>
              <div>
                <h3
                  class="text-xl font-bold text-surface-900 dark:text-surface-0 tracking-tight"
                >
                  Gesti√≥n de Usuarios
                </h3>
                <p class="text-surface-500 dark:text-surface-400 text-sm">
                  Administra los accesos del sistema
                </p>
              </div>
            </div>

            <p-button
              icon="pi pi-plus"
              label="Nuevo Usuario"
              severity="primary"
              styleClass="rounded-xl shadow-lg shadow-primary-500/20"
              (click)="mostrarNuevoUsuario()"
            >
            </p-button>
          </div>

          <!-- Zen Table -->
          <div
            class="bg-surface-0 dark:bg-surface-900 rounded-[2rem] border border-surface-200 dark:border-surface-800 overflow-hidden shadow-sm"
          >
            <p-table
              [value]="usuarios"
              styleClass="p-datatable-sm"
              [paginator]="true"
              [rows]="10"
              [responsive]="true"
              [rowHover]="true"
            >
              <ng-template pTemplate="header">
                <tr class="bg-surface-50/50 dark:bg-surface-800/20">
                  <th
                    class="py-4 px-6 text-xs font-bold uppercase text-surface-500 dark:text-surface-400 tracking-wider border-b border-surface-100 dark:border-surface-800"
                  >
                    Usuario
                  </th>
                  <th
                    class="py-4 px-6 text-xs font-bold uppercase text-surface-500 dark:text-surface-400 tracking-wider border-b border-surface-100 dark:border-surface-800"
                  >
                    Contacto
                  </th>
                  <th
                    class="py-4 px-6 text-xs font-bold uppercase text-surface-500 dark:text-surface-400 tracking-wider border-b border-surface-100 dark:border-surface-800"
                  >
                    Rol
                  </th>
                  <th
                    class="py-4 px-6 text-xs font-bold uppercase text-surface-500 dark:text-surface-400 tracking-wider border-b border-surface-100 dark:border-surface-800"
                  >
                    Estado
                  </th>
                  <th
                    class="py-4 px-6 text-xs font-bold uppercase text-surface-500 dark:text-surface-400 tracking-wider border-b border-surface-100 dark:border-surface-800 text-right"
                  >
                    Acciones
                  </th>
                </tr>
              </ng-template>

              <ng-template pTemplate="emptymessage">
                <tr>
                  <td colspan="5" class="p-12 text-center">
                    <div
                      class="flex flex-col items-center justify-center opacity-60"
                    >
                      <i
                        class="pi pi-users text-6xl text-surface-300 dark:text-surface-600 mb-4"
                      ></i>
                      <p
                        class="text-surface-600 dark:text-surface-400 font-medium"
                      >
                        No hay usuarios registrados
                      </p>
                    </div>
                  </td>
                </tr>
              </ng-template>

              <ng-template pTemplate="body" let-usuario>
                <tr
                  class="transition-colors duration-200 hover:bg-surface-50 dark:hover:bg-surface-800/30"
                >
                  <td
                    class="py-4 px-6 border-b border-surface-50 dark:border-surface-800/50"
                  >
                    <div class="flex items-center gap-3">
                      <div
                        class="w-10 h-10 rounded-xl bg-gradient-to-br from-surface-100 to-surface-200 dark:from-surface-700 dark:to-surface-800 flex items-center justify-center font-bold text-surface-600 dark:text-surface-300 text-sm"
                      >
                        {{ usuario.nombre.charAt(0).toUpperCase() }}
                      </div>
                      <div class="flex flex-col">
                        <span
                          class="font-bold text-surface-900 dark:text-surface-0 text-sm"
                          >{{ usuario.nombre }}</span
                        >
                        <span
                          class="text-xs text-surface-500 dark:text-surface-400"
                          >&#64;{{ usuario.username }}</span
                        >
                      </div>
                    </div>
                  </td>
                  <td
                    class="py-4 px-6 border-b border-surface-50 dark:border-surface-800/50"
                  >
                    <div class="flex flex-col gap-1">
                      <div
                        class="flex items-center gap-2 text-xs text-surface-600 dark:text-surface-300"
                      >
                        <i class="pi pi-envelope text-surface-400"></i>
                        {{ usuario.email }}
                      </div>
                      <div
                        *ngIf="usuario.telefono"
                        class="flex items-center gap-2 text-xs text-surface-600 dark:text-surface-300"
                      >
                        <i class="pi pi-phone text-surface-400"></i>
                        {{ usuario.telefono }}
                      </div>
                    </div>
                  </td>
                  <td
                    class="py-4 px-6 border-b border-surface-50 dark:border-surface-800/50"
                  >
                    <span
                      class="inline-flex items-center gap-1.5 px-2.5 py-1 rounded-lg text-xs font-semibold bg-surface-100 dark:bg-surface-800 text-surface-700 dark:text-surface-300 border border-surface-200 dark:border-surface-700"
                    >
                      <i [class]="getRolIcon(usuario.rol)"></i>
                      {{ usuario.rol }}
                    </span>
                  </td>
                  <td
                    class="py-4 px-6 border-b border-surface-50 dark:border-surface-800/50"
                  >
                    <div class="flex items-center gap-2">
                      <span class="relative flex h-2.5 w-2.5">
                        <span
                          class="animate-ping absolute inline-flex h-full w-full rounded-full opacity-75"
                          [ngClass]="
                            usuario.estado === 'ACTIVO'
                              ? 'bg-emerald-400'
                              : 'bg-surface-400'
                          "
                        ></span>
                        <span
                          class="relative inline-flex rounded-full h-2.5 w-2.5"
                          [ngClass]="
                            usuario.estado === 'ACTIVO'
                              ? 'bg-emerald-500'
                              : 'bg-surface-500'
                          "
                        ></span>
                      </span>
                      <span
                        class="text-xs font-medium text-surface-600 dark:text-surface-300"
                        >{{ usuario.estado }}</span
                      >
                    </div>
                  </td>
                  <td
                    class="py-4 px-6 border-b border-surface-50 dark:border-surface-800/50 text-right"
                  >
                    <div class="flex items-center justify-end gap-2">
                      <button
                        (click)="editarUsuario(usuario)"
                        class="w-8 h-8 rounded-full flex items-center justify-center text-surface-500 hover:text-primary-600 hover:bg-primary-50 dark:hover:bg-primary-900/20 transition-all"
                      >
                        <i class="pi pi-pencil text-sm"></i>
                      </button>
                      <button
                        (click)="eliminarUsuario(usuario)"
                        [disabled]="
                          usuario.username === currentUser.toLowerCase()
                        "
                        class="w-8 h-8 rounded-full flex items-center justify-center text-surface-500 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 transition-all disabled:opacity-50"
                      >
                        <i class="pi pi-trash text-sm"></i>
                      </button>
                    </div>
                  </td>
                </tr>
              </ng-template>
            </p-table>
          </div>
        </div>
      </section>

      <!-- 1. üè™ CONFIGURACI√ìN DEL NEGOCIO -->
      <section *ngSwitchCase="1" class="animate-fade-in-up">
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
          <!-- Header / Sidebar Info -->
          <div class="lg:col-span-1 space-y-6">
            <div
              class="bg-surface-0 dark:bg-surface-900 rounded-[2rem] p-6 border border-surface-200 dark:border-surface-800 shadow-sm"
            >
              <div class="text-center mb-6">
                <div class="relative inline-block">
                  <div
                    class="w-32 h-32 rounded-[2rem] bg-surface-50 dark:bg-surface-800 flex items-center justify-center mx-auto overflow-hidden border-2 border-dashed border-surface-200 dark:border-surface-700 hover:border-primary-500 transition-colors cursor-pointer group"
                  >
                    <img
                      *ngIf="configNegocio.logo"
                      [src]="configNegocio.logo"
                      class="w-full h-full object-contain p-2"
                    />
                    <div
                      *ngIf="!configNegocio.logo"
                      class="flex flex-col items-center gap-2 text-surface-400 group-hover:text-primary-500"
                    >
                      <i class="pi pi-image text-3xl"></i>
                      <span class="text-xs font-medium">Subir Logo</span>
                    </div>
                    <!-- Hidden File Upload overlay/trigger would go here, simplified for now -->
                  </div>
                  <div
                    class="absolute -bottom-2 -right-2 bg-white dark:bg-surface-800 p-2 rounded-full shadow-md border border-surface-100 dark:border-surface-700"
                  >
                    <p-fileUpload
                      mode="basic"
                      chooseIcon="pi pi-pencil"
                      styleClass="p-button-rounded p-button-text p-button-sm"
                      [auto]="true"
                      (onSelect)="onUploadLogo($event)"
                    ></p-fileUpload>
                  </div>
                </div>
                <h3
                  class="mt-4 text-xl font-bold text-surface-900 dark:text-surface-0"
                >
                  {{ configNegocio.nombre || "Nombre Empresa" }}
                </h3>
                <p class="text-surface-500 dark:text-surface-400 text-sm">
                  {{ configNegocio.slogan || "Sin slogan definido" }}
                </p>
              </div>

              <div class="space-y-3">
                <div
                  class="flex items-center gap-3 p-3 bg-surface-50 dark:bg-surface-800/50 rounded-xl"
                >
                  <div
                    class="w-8 h-8 rounded-lg bg-white dark:bg-surface-800 flex items-center justify-center text-surface-500 shadow-sm"
                  >
                    <i class="pi pi-id-card"></i>
                  </div>
                  <div class="flex-1 overflow-hidden">
                    <p class="text-xs text-surface-500 uppercase font-bold">
                      RUC
                    </p>
                    <p
                      class="text-sm font-medium text-surface-900 dark:text-surface-0 truncate"
                    >
                      {{ configNegocio.ruc || "---" }}
                    </p>
                  </div>
                </div>
                <div
                  class="flex items-center gap-3 p-3 bg-surface-50 dark:bg-surface-800/50 rounded-xl"
                >
                  <div
                    class="w-8 h-8 rounded-lg bg-white dark:bg-surface-800 flex items-center justify-center text-surface-500 shadow-sm"
                  >
                    <i class="pi pi-map-marker"></i>
                  </div>
                  <div class="flex-1 overflow-hidden">
                    <p class="text-xs text-surface-500 uppercase font-bold">
                      Direcci√≥n
                    </p>
                    <p
                      class="text-sm font-medium text-surface-900 dark:text-surface-0 truncate"
                    >
                      {{ configNegocio.direccion || "---" }}
                    </p>
                  </div>
                </div>
              </div>
            </div>

            <button
              class="w-full py-4 bg-primary-600 hover:bg-primary-700 text-white rounded-[1.5rem] font-bold shadow-lg shadow-primary-500/30 transition-all active:scale-95 flex items-center justify-center gap-2"
              (click)="guardarConfiguracionNegocio()"
              [disabled]="guardando"
            >
              <i
                class="pi"
                [ngClass]="guardando ? 'pi-spin pi-spinner' : 'pi-save'"
              ></i>
              <span>{{ guardando ? "Guardando..." : "Guardar Cambios" }}</span>
            </button>
          </div>

          <!-- Form Content -->
          <div class="lg:col-span-2 space-y-6">
            <!-- Datos Generales -->
            <div
              class="bg-surface-0 dark:bg-surface-900 rounded-[2rem] p-8 border border-surface-200 dark:border-surface-800 shadow-sm"
            >
              <h4
                class="text-lg font-bold text-surface-900 dark:text-surface-0 mb-6 flex items-center gap-2"
              >
                <i class="pi pi-info-circle text-primary-500"></i> Informaci√≥n
                General
              </h4>
              <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="space-y-2">
                  <label
                    class="text-sm font-medium text-surface-700 dark:text-surface-300"
                    >Nombre Comercial</label
                  >
                  <input
                    pInputText
                    [(ngModel)]="configNegocio.nombre"
                    class="w-full rounded-2xl bg-surface-50 dark:bg-surface-800 border-surface-200 dark:border-surface-700 focus:border-primary-500"
                    placeholder="Ej: Mi Tienda S.A.C."
                  />
                </div>
                <div class="space-y-2">
                  <label
                    class="text-sm font-medium text-surface-700 dark:text-surface-300"
                    >RUC</label
                  >
                  <input
                    pInputText
                    [(ngModel)]="configNegocio.ruc"
                    class="w-full rounded-2xl bg-surface-50 dark:bg-surface-800 border-surface-200 dark:border-surface-700 focus:border-primary-500"
                    placeholder="20100000000"
                    maxlength="11"
                  />
                </div>
                <div class="md:col-span-2 space-y-2">
                  <label
                    class="text-sm font-medium text-surface-700 dark:text-surface-300"
                    >Slogan</label
                  >
                  <input
                    pInputText
                    [(ngModel)]="configNegocio.slogan"
                    class="w-full rounded-2xl bg-surface-50 dark:bg-surface-800 border-surface-200 dark:border-surface-700 focus:border-primary-500"
                    placeholder="Frase distintiva de la empresa"
                  />
                </div>
              </div>
            </div>

            <!-- Contacto -->
            <div
              class="bg-surface-0 dark:bg-surface-900 rounded-[2rem] p-8 border border-surface-200 dark:border-surface-800 shadow-sm"
            >
              <h4
                class="text-lg font-bold text-surface-900 dark:text-surface-0 mb-6 flex items-center gap-2"
              >
                <i class="pi pi-phone text-indigo-500"></i> Contacto y Ubicaci√≥n
              </h4>
              <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="md:col-span-2 space-y-2">
                  <label
                    class="text-sm font-medium text-surface-700 dark:text-surface-300"
                    >Direcci√≥n Fiscal</label
                  >
                  <input
                    pInputText
                    [(ngModel)]="configNegocio.direccion"
                    class="w-full rounded-2xl bg-surface-50 dark:bg-surface-800 border-surface-200 dark:border-surface-700 focus:border-primary-500"
                    placeholder="Av. Principal 123"
                  />
                </div>
                <div class="space-y-2">
                  <label
                    class="text-sm font-medium text-surface-700 dark:text-surface-300"
                    >Tel√©fono</label
                  >
                  <input
                    pInputText
                    [(ngModel)]="configNegocio.telefono"
                    class="w-full rounded-2xl bg-surface-50 dark:bg-surface-800 border-surface-200 dark:border-surface-700 focus:border-primary-500"
                  />
                </div>
                <div class="space-y-2">
                  <label
                    class="text-sm font-medium text-surface-700 dark:text-surface-300"
                    >Email</label
                  >
                  <input
                    pInputText
                    [(ngModel)]="configNegocio.email"
                    class="w-full rounded-2xl bg-surface-50 dark:bg-surface-800 border-surface-200 dark:border-surface-700 focus:border-primary-500"
                  />
                </div>
                <div class="space-y-2">
                  <label
                    class="text-sm font-medium text-surface-700 dark:text-surface-300"
                    >Sitio Web</label
                  >
                  <input
                    pInputText
                    [(ngModel)]="configNegocio.website"
                    class="w-full rounded-2xl bg-surface-50 dark:bg-surface-800 border-surface-200 dark:border-surface-700 focus:border-primary-500"
                  />
                </div>
              </div>
            </div>

            <!-- Operativo -->
            <div
              class="bg-surface-0 dark:bg-surface-900 rounded-[2rem] p-8 border border-surface-200 dark:border-surface-800 shadow-sm"
            >
              <h4
                class="text-lg font-bold text-surface-900 dark:text-surface-0 mb-6 flex items-center gap-2"
              >
                <i class="pi pi-cog text-emerald-500"></i> Configuraci√≥n
                Operativa
              </h4>
              <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="space-y-2">
                  <label
                    class="text-sm font-medium text-surface-700 dark:text-surface-300"
                    >Moneda</label
                  >
                  <p-dropdown
                    [options]="opcionesMoneda"
                    [(ngModel)]="configNegocio.moneda"
                    styleClass="w-full rounded-2xl"
                    placeholder="Seleccionar"
                  ></p-dropdown>
                </div>
                <div class="space-y-2">
                  <label
                    class="text-sm font-medium text-surface-700 dark:text-surface-300"
                    >Apertura</label
                  >
                  <input
                    type="time"
                    pInputText
                    [(ngModel)]="configNegocio.horarioApertura"
                    class="w-full rounded-2xl bg-surface-50 dark:bg-surface-800 border-surface-200 dark:border-surface-700"
                  />
                </div>
                <div class="space-y-2">
                  <label
                    class="text-sm font-medium text-surface-700 dark:text-surface-300"
                    >Cierre</label
                  >
                  <input
                    type="time"
                    pInputText
                    [(ngModel)]="configNegocio.horarioCierre"
                    class="w-full rounded-2xl bg-surface-50 dark:bg-surface-800 border-surface-200 dark:border-surface-700"
                  />
                </div>
                <div class="col-span-full pt-2">
                  <label
                    class="text-sm font-medium text-surface-700 dark:text-surface-300 mb-3 block"
                    >D√≠as Laborales</label
                  >
                  <div class="flex flex-wrap gap-3">
                    <div
                      *ngFor="let dia of diasSemana"
                      (click)="toggleDiaLaboral(dia.value)"
                      class="cursor-pointer px-4 py-2 rounded-xl text-sm font-semibold transition-all select-none border"
                      [ngClass]="
                        configNegocio.diasLaborales.includes(dia.value)
                          ? 'bg-primary-100 dark:bg-primary-900/40 text-primary-700 dark:text-primary-300 border-primary-200 dark:border-primary-700'
                          : 'bg-surface-50 dark:bg-surface-800 text-surface-500 dark:text-surface-400 border-surface-200 dark:border-surface-700 hover:bg-surface-100'
                      "
                    >
                      {{ dia.label }}
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- 2. üñ®Ô∏è IMPRESORAS -->
      <section *ngSwitchCase="2" class="animate-fade-in-up">
        <!-- Empty State (No hay impresoras) -->
        <div
          *ngIf="impresoras.length === 0"
          class="flex flex-col items-center justify-center p-16 bg-surface-0 dark:bg-surface-900 rounded-[2rem] border border-surface-200 dark:border-surface-800 shadow-sm text-center"
        >
          <div
            class="w-24 h-24 mb-6 rounded-full bg-violet-50 dark:bg-violet-900/30 flex items-center justify-center"
          >
            <i class="pi pi-print text-4xl text-violet-500"></i>
          </div>
          <h3
            class="text-2xl font-bold text-surface-900 dark:text-surface-0 mb-3"
          >
            No hay impresoras configuradas
          </h3>
          <p
            class="text-surface-600 dark:text-surface-400 max-w-md mx-auto mb-8"
          >
            Configura tu primera impresora para comenzar a emitir tickets y
            comprobantes. El sistema soporta impresoras USB y de Red.
          </p>
          <p-button
            icon="pi pi-plus"
            label="Agregar Primera Impresora"
            severity="help"
            styleClass="rounded-xl px-6 py-3 shadow-lg shadow-violet-500/20"
            (click)="mostrarNuevaImpresora()"
          ></p-button>
        </div>

        <!-- Grid de impresoras -->
        <div *ngIf="impresoras.length > 0" class="space-y-6">
          <div
            class="flex justify-between items-center bg-surface-0 dark:bg-surface-900 p-6 rounded-[2rem] border border-surface-200 dark:border-surface-800 shadow-sm"
          >
            <div>
              <h3
                class="text-xl font-bold text-surface-900 dark:text-surface-0 tracking-tight"
              >
                Impresoras Conectadas
              </h3>
              <p class="text-surface-500 dark:text-surface-400 text-sm">
                Gestiona tus dispositivos de impresi√≥n
              </p>
            </div>
            <p-button
              icon="pi pi-plus"
              label="Agregar Impresora"
              [text]="true"
              [rounded]="true"
              severity="help"
              (click)="mostrarFormularioImpresora = true"
            ></p-button>
          </div>

          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <!-- Card Impresora -->
            <div
              *ngFor="let impresora of impresoras; trackBy: trackByImpresoraId"
              class="group relative bg-surface-0 dark:bg-surface-900 rounded-[2rem] border border-surface-200 dark:border-surface-800 shadow-sm hover:shadow-xl hover:-translate-y-1 transition-all duration-300 overflow-hidden"
            >
              <!-- Status Bar -->
              <div
                class="absolute top-0 inset-x-0 h-1"
                [ngClass]="
                  impresora.estado === 'CONECTADA'
                    ? 'bg-emerald-500'
                    : 'bg-surface-300 dark:bg-surface-700'
                "
              ></div>

              <div class="p-6">
                <div class="flex justify-between items-start mb-6">
                  <div
                    class="w-14 h-14 rounded-2xl flex items-center justify-center text-white shadow-lg"
                    [ngClass]="getImpresoraTipoClasses(impresora.tipo)"
                  >
                    <i class="pi pi-print text-2xl"></i>
                  </div>
                  <div
                    *ngIf="impresora.esDefault"
                    class="bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-300 px-3 py-1 rounded-full text-xs font-bold flex items-center gap-1 border border-yellow-200 dark:border-yellow-800"
                  >
                    <i class="pi pi-star-fill text-[10px]"></i> Principal
                  </div>
                </div>

                <h4
                  class="text-lg font-bold text-surface-900 dark:text-surface-0 mb-1"
                >
                  {{ impresora.nombre }}
                </h4>
                <p
                  class="text-sm text-surface-500 dark:text-surface-400 mb-4 flex items-center gap-1"
                >
                  <i class="pi pi-map-marker text-xs"></i>
                  {{ impresora.ubicacion }}
                </p>

                <div
                  class="space-y-3 p-4 bg-surface-50 dark:bg-surface-800/50 rounded-xl mb-6"
                >
                  <div class="flex justify-between text-sm">
                    <span class="text-surface-500 dark:text-surface-400"
                      >Tipo</span
                    >
                    <span
                      class="font-medium text-surface-900 dark:text-surface-0"
                      >{{ impresora.tipo }}</span
                    >
                  </div>
                  <div class="flex justify-between text-sm">
                    <span class="text-surface-500 dark:text-surface-400"
                      >Papel</span
                    >
                    <span
                      class="font-medium text-surface-900 dark:text-surface-0"
                      >{{ impresora.tamanoPapel }}</span
                    >
                  </div>
                  <div
                    *ngIf="impresora.ip"
                    class="flex justify-between text-sm"
                  >
                    <span class="text-surface-500 dark:text-surface-400"
                      >IP</span
                    >
                    <span
                      class="font-medium text-surface-900 dark:text-surface-0 font-mono"
                      >{{ impresora.ip }}</span
                    >
                  </div>
                </div>

                <div class="flex gap-2">
                  <p-button
                    label="Probar"
                    icon="pi pi-wifi"
                    styleClass="w-full p-button-sm p-button-outlined p-button-secondary rounded-xl"
                    [loading]="testConexionImpresora"
                    (click)="testearConexionImpresora(impresora)"
                  >
                  </p-button>
                  <p-button
                    *ngIf="!impresora.esDefault"
                    icon="pi pi-star"
                    styleClass="p-button-sm p-button-outlined p-button-warning rounded-xl"
                    pTooltip="Hacer Principal"
                    (click)="establecerImpresoraDefault(impresora)"
                  >
                  </p-button>
                  <p-button
                    icon="pi pi-pencil"
                    styleClass="p-button-sm p-button-outlined rounded-xl"
                    (click)="editarImpresora(impresora)"
                  >
                  </p-button>
                  <p-button
                    icon="pi pi-trash"
                    styleClass="p-button-sm p-button-outlined p-button-danger rounded-xl"
                    (click)="eliminarImpresora(impresora)"
                  >
                  </p-button>
                </div>
              </div>
            </div>

            <!-- Card Agregar (Empty slot style) -->
            <div
              class="group min-h-[300px] bg-surface-0 dark:bg-surface-900 rounded-[2rem] border-2 border-dashed border-surface-200 dark:border-surface-700 hover:border-violet-500 dark:hover:border-violet-400 transition-all duration-300 flex flex-col items-center justify-center cursor-pointer gap-4 p-6"
              (click)="mostrarFormularioImpresora = true"
            >
              <div
                class="w-16 h-16 rounded-full bg-surface-50 dark:bg-surface-800 group-hover:bg-violet-50 dark:group-hover:bg-violet-900/20 flex items-center justify-center transition-colors"
              >
                <i
                  class="pi pi-plus text-2xl text-surface-400 dark:text-surface-500 group-hover:text-violet-500 mx-auto"
                ></i>
              </div>
              <span
                class="font-bold text-surface-600 dark:text-surface-400 group-hover:text-violet-500 transition-colors"
                >Configurar Nueva Impresora</span
              >
            </div>
          </div>
        </div>
      </section>

      <!-- 3. üí∞ FISCAL -->
      <section *ngSwitchCase="3" class="animate-fade-in-up">
        <!-- Header Section -->
        <div
          class="mb-8 p-6 bg-surface-0 dark:bg-surface-900 rounded-[2rem] border border-surface-200 dark:border-surface-800 shadow-sm flex flex-col md:flex-row md:items-center justify-between gap-4"
        >
          <div>
            <h3
              class="text-xl font-bold text-surface-900 dark:text-surface-0 tracking-tight flex items-center gap-2"
            >
              <i class="pi pi-briefcase text-amber-500"></i> Configuraci√≥n
              Fiscal
            </h3>
            <p class="text-surface-500 dark:text-surface-400 text-sm mt-1">
              Gestiona tu facturaci√≥n electr√≥nica y par√°metros SUNAT
            </p>
          </div>
          <div
            class="px-4 py-2 bg-amber-50 dark:bg-amber-900/20 text-amber-700 dark:text-amber-300 rounded-xl text-sm font-semibold border border-amber-100 dark:border-amber-800/30"
          >
            <i class="pi pi-user mr-2"></i> {{ currentUser }}
          </div>
        </div>

        <div class="grid grid-cols-1 xl:grid-cols-3 gap-8">
          <!-- Column 1: SUNAT Connection -->
          <div class="xl:col-span-1 space-y-8">
            <div
              class="bg-surface-0 dark:bg-surface-900 rounded-[2.5rem] p-8 border border-surface-200 dark:border-surface-800 shadow-sm relative overflow-hidden group"
            >
              <div
                class="absolute top-0 right-0 p-8 opacity-5 group-hover:opacity-10 transition-opacity"
              >
                <i class="pi pi-globe text-9xl text-amber-500"></i>
              </div>

              <h4
                class="text-lg font-bold text-surface-900 dark:text-surface-0 mb-6 flex items-center gap-2 relative z-10"
              >
                <span
                  class="w-8 h-8 rounded-lg bg-amber-100 dark:bg-amber-900/40 flex items-center justify-center text-amber-600 dark:text-amber-400"
                  ><i class="pi pi-cloud"></i
                ></span>
                Conexi√≥n SUNAT
              </h4>

              <div class="space-y-6 relative z-10">
                <!-- Entorno Switch -->
                <div
                  class="p-4 bg-surface-50 dark:bg-surface-800/50 rounded-[1.5rem] border border-surface-100 dark:border-surface-700"
                >
                  <p
                    class="text-xs font-bold text-surface-500 dark:text-surface-400 uppercase mb-3 ml-1"
                  >
                    Entorno de Operaci√≥n
                  </p>
                  <div
                    class="flex bg-surface-200 dark:bg-surface-700 p-1.5 rounded-2xl"
                  >
                    <div
                      class="flex-1 py-2 px-3 rounded-xl text-center text-sm font-bold cursor-pointer transition-all"
                      [ngClass]="
                        configFiscal.entornoSunat === 'BETA'
                          ? 'bg-white dark:bg-surface-800 text-amber-600 shadow-sm'
                          : 'text-surface-500 dark:text-surface-400 hover:text-surface-700'
                      "
                      (click)="configFiscal.entornoSunat = 'BETA'"
                    >
                      BETA
                    </div>
                    <div
                      class="flex-1 py-2 px-3 rounded-xl text-center text-sm font-bold cursor-pointer transition-all"
                      [ngClass]="
                        configFiscal.entornoSunat === 'PRODUCCION'
                          ? 'bg-emerald-500 text-white shadow-lg shadow-emerald-500/30'
                          : 'text-surface-500 dark:text-surface-400 hover:text-surface-700'
                      "
                      (click)="configFiscal.entornoSunat = 'PRODUCCION'"
                    >
                      PRODUCCI√ìN
                    </div>
                  </div>
                </div>

                <!-- Credentials -->
                <div class="space-y-4">
                  <span class="p-float-label">
                    <input
                      pInputText
                      id="usuarioSol"
                      [(ngModel)]="configFiscal.usuarioSol"
                      class="w-full p-3 rounded-2xl bg-surface-50 dark:bg-surface-800 border-0 focus:ring-2 focus:ring-amber-500/20 transition-all font-mono text-sm"
                    />
                    <label for="usuarioSol">Usuario SOL</label>
                  </span>
                  <span class="p-float-label">
                    <p-password
                      [(ngModel)]="configFiscal.claveSol"
                      [toggleMask]="true"
                      [feedback]="false"
                      styleClass="w-full"
                      inputStyleClass="w-full p-3 rounded-2xl bg-surface-50 dark:bg-surface-800 border-0 focus:ring-2 focus:ring-amber-500/20 transition-all font-mono text-sm"
                    ></p-password>
                    <label>Clave SOL</label>
                  </span>
                </div>

                <!-- Emisor Switch -->
                <div
                  class="flex items-center justify-between p-4 bg-surface-50 dark:bg-surface-800/50 rounded-[1.5rem] border border-surface-100 dark:border-surface-700"
                >
                  <div class="flex flex-col">
                    <span class="font-bold text-surface-900 dark:text-surface-0"
                      >Emisor Electr√≥nico</span
                    >
                    <span class="text-xs text-surface-500"
                      >Habilitar facturaci√≥n</span
                    >
                  </div>
                  <p-inputSwitch
                    [(ngModel)]="configFiscal.emisorElectronico"
                  ></p-inputSwitch>
                </div>
              </div>
            </div>
          </div>

          <!-- Column 2: Series -->
          <div class="xl:col-span-2 space-y-8">
            <div
              class="bg-surface-0 dark:bg-surface-900 rounded-[2.5rem] p-8 border border-surface-200 dark:border-surface-800 shadow-sm"
            >
              <h4
                class="text-lg font-bold text-surface-900 dark:text-surface-0 mb-6 flex items-center gap-2"
              >
                <span
                  class="w-8 h-8 rounded-lg bg-emerald-100 dark:bg-emerald-900/40 flex items-center justify-center text-emerald-600 dark:text-emerald-400"
                  ><i class="pi pi-ticket"></i
                ></span>
                Series y Numeraci√≥n
              </h4>

              <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <!-- Factura -->
                <div
                  class="p-6 rounded-[2rem] bg-indigo-50 dark:bg-indigo-900/10 border border-indigo-100 dark:border-indigo-800/30"
                >
                  <div class="flex items-center gap-3 mb-4">
                    <div
                      class="w-10 h-10 rounded-full bg-white dark:bg-surface-800 flex items-center justify-center text-indigo-500 shadow-sm"
                    >
                      <i class="pi pi-file"></i>
                    </div>
                    <div>
                      <p
                        class="text-xs font-bold text-indigo-600 dark:text-indigo-400 uppercase tracking-wider"
                      >
                        Facturas
                      </p>
                      <p class="text-xs text-indigo-400 dark:text-indigo-500">
                        Comprobante Tipo 01
                      </p>
                    </div>
                  </div>
                  <input
                    pInputText
                    [(ngModel)]="configFiscal.serieFactura"
                    class="w-full text-center text-xl font-bold font-mono tracking-widest text-indigo-700 dark:text-indigo-300 bg-white/50 dark:bg-surface-800/50 border-0 rounded-xl p-3 focus:ring-2 focus:ring-indigo-500/20"
                    maxlength="4"
                    placeholder="F001"
                  />
                </div>

                <!-- Boleta -->
                <div
                  class="p-6 rounded-[2rem] bg-emerald-50 dark:bg-emerald-900/10 border border-emerald-100 dark:border-emerald-800/30"
                >
                  <div class="flex items-center gap-3 mb-4">
                    <div
                      class="w-10 h-10 rounded-full bg-white dark:bg-surface-800 flex items-center justify-center text-emerald-500 shadow-sm"
                    >
                      <i class="pi pi-ticket"></i>
                    </div>
                    <div>
                      <p
                        class="text-xs font-bold text-emerald-600 dark:text-emerald-400 uppercase tracking-wider"
                      >
                        Boletas
                      </p>
                      <p class="text-xs text-emerald-400 dark:text-emerald-500">
                        Comprobante Tipo 03
                      </p>
                    </div>
                  </div>
                  <input
                    pInputText
                    [(ngModel)]="configFiscal.serieBoleta"
                    class="w-full text-center text-xl font-bold font-mono tracking-widest text-emerald-700 dark:text-emerald-300 bg-white/50 dark:bg-surface-800/50 border-0 rounded-xl p-3 focus:ring-2 focus:ring-emerald-500/20"
                    maxlength="4"
                    placeholder="B001"
                  />
                </div>

                <!-- Nota -->
                <div
                  class="p-6 rounded-[2rem] bg-violet-50 dark:bg-violet-900/10 border border-violet-100 dark:border-violet-800/30"
                >
                  <div class="flex items-center gap-3 mb-4">
                    <div
                      class="w-10 h-10 rounded-full bg-white dark:bg-surface-800 flex items-center justify-center text-violet-500 shadow-sm"
                    >
                      <i class="pi pi-copy"></i>
                    </div>
                    <div>
                      <p
                        class="text-xs font-bold text-violet-600 dark:text-violet-400 uppercase tracking-wider"
                      >
                        Notas
                      </p>
                      <p class="text-xs text-violet-400 dark:text-violet-500">
                        Cr√©dito / D√©bito
                      </p>
                    </div>
                  </div>
                  <input
                    pInputText
                    [(ngModel)]="configFiscal.serieNota"
                    class="w-full text-center text-xl font-bold font-mono tracking-widest text-violet-700 dark:text-violet-300 bg-white/50 dark:bg-surface-800/50 border-0 rounded-xl p-3 focus:ring-2 focus:ring-violet-500/20"
                    maxlength="4"
                    placeholder="N001"
                  />
                </div>
              </div>

              <!-- Status Cards -->
              <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 mt-8">
                <div
                  class="flex items-center gap-4 p-4 rounded-2xl bg-surface-50 dark:bg-surface-800/50 border border-surface-100 dark:border-surface-700"
                >
                  <div
                    class="w-10 h-10 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center text-green-600 dark:text-green-400"
                  >
                    <i class="pi pi-shield-check"></i>
                  </div>
                  <div>
                    <p
                      class="text-xs text-surface-500 dark:text-surface-400 font-medium"
                    >
                      Certificado Digital
                    </p>
                    <p
                      class="text-sm font-bold text-green-600 dark:text-green-400"
                    >
                      V√°lido 2025
                    </p>
                  </div>
                </div>
                <div
                  class="flex items-center gap-4 p-4 rounded-2xl bg-surface-50 dark:bg-surface-800/50 border border-surface-100 dark:border-surface-700"
                >
                  <div
                    class="w-10 h-10 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center text-blue-600 dark:text-blue-400"
                  >
                    <i class="pi pi-wifi"></i>
                  </div>
                  <div>
                    <p
                      class="text-xs text-surface-500 dark:text-surface-400 font-medium"
                    >
                      Conexi√≥n OSE
                    </p>
                    <p
                      class="text-sm font-bold text-blue-600 dark:text-blue-400"
                    >
                      En L√≠nea
                    </p>
                  </div>
                </div>
                <div
                  class="flex items-center gap-4 p-4 rounded-2xl bg-surface-50 dark:bg-surface-800/50 border border-surface-100 dark:border-surface-700"
                >
                  <div
                    class="w-10 h-10 rounded-full bg-yellow-100 dark:bg-yellow-900/30 flex items-center justify-center text-yellow-600 dark:text-yellow-400"
                  >
                    <i class="pi pi-sync"></i>
                  </div>
                  <div>
                    <p
                      class="text-xs text-surface-500 dark:text-surface-400 font-medium"
                    >
                      Sincronizaci√≥n
                    </p>
                    <p
                      class="text-sm font-bold text-yellow-600 dark:text-yellow-400"
                    >
                      2h atr√°s
                    </p>
                  </div>
                </div>
              </div>
            </div>

            <!-- Action Button -->
            <p-button
              label="Guardar Configuraci√≥n Fiscal"
              icon="pi pi-save"
              styleClass="w-full py-4 rounded-[1.5rem] shadow-xl shadow-primary-500/20"
              [loading]="guardando"
              (click)="guardarConfiguracionFiscal()"
            >
            </p-button>
          </div>
        </div>
      </section>

      <!-- 4. üé® PERSONALIZACI√ìN -->
      <section *ngSwitchCase="4" class="animate-fade-in-up">
        <!-- Header Section -->
        <div
          class="mb-8 p-6 bg-surface-0 dark:bg-surface-900 rounded-[2rem] border border-surface-200 dark:border-surface-800 shadow-sm flex flex-col md:flex-row md:items-center justify-between gap-4"
        >
          <div>
            <h3
              class="text-xl font-bold text-surface-900 dark:text-surface-0 tracking-tight flex items-center gap-2"
            >
              <i class="pi pi-palette text-rose-500"></i> Personalizaci√≥n del
              Sistema
            </h3>
            <p class="text-surface-500 dark:text-surface-400 text-sm mt-1">
              Adapta la apariencia visual a tu marca
            </p>
          </div>
          <div class="flex gap-2">
            <p-button
              icon="pi pi-refresh"
              label="Resetear"
              [text]="true"
              severity="secondary"
              size="small"
              (click)="resetearTema()"
            >
            </p-button>
            <p-button
              icon="pi pi-check"
              label="Aplicar Cambios"
              rounded="true"
              severity="help"
              size="small"
              [loading]="guardando"
              (click)="aplicarTema()"
            >
            </p-button>
          </div>
        </div>

        <div class="grid grid-cols-1 xl:grid-cols-3 gap-8">
          <!-- Column 1: Config -->
          <div class="xl:col-span-1 space-y-6">
            <!-- Color Scheme -->
            <div
              class="bg-surface-0 dark:bg-surface-900 rounded-[2.5rem] p-8 border border-surface-200 dark:border-surface-800 shadow-sm"
            >
              <h4
                class="text-lg font-bold text-surface-900 dark:text-surface-0 mb-6 flex items-center gap-2"
              >
                <span
                  class="w-8 h-8 rounded-lg bg-rose-100 dark:bg-rose-900/40 flex items-center justify-center text-rose-600 dark:text-rose-400"
                  ><i class="pi pi-palette"></i
                ></span>
                Esquema de Colores
              </h4>

              <div class="space-y-5">
                <!-- Primary -->
                <div class="space-y-2">
                  <label
                    class="text-xs font-bold text-surface-500 dark:text-surface-400 uppercase tracking-wider ml-1"
                    >Color Principal</label
                  >
                  <div
                    class="flex items-center gap-3 p-2 rounded-2xl bg-surface-50 dark:bg-surface-800/50 border border-surface-100 dark:border-surface-700"
                  >
                    <p-colorPicker
                      [(ngModel)]="temaActual.colorPrimario"
                      styleClass="scale-110 ml-1"
                    ></p-colorPicker>
                    <input
                      pInputText
                      [(ngModel)]="temaActual.colorPrimario"
                      class="flex-1 bg-transparent border-0 font-mono text-surface-900 dark:text-surface-0 focus:ring-0"
                    />
                    <div
                      class="w-6 h-6 rounded-full border border-surface-200 dark:border-surface-600"
                      [style.background]="temaActual.colorPrimario"
                    ></div>
                  </div>
                </div>

                <!-- Secondary -->
                <div class="space-y-2">
                  <label
                    class="text-xs font-bold text-surface-500 dark:text-surface-400 uppercase tracking-wider ml-1"
                    >Color Secundario</label
                  >
                  <div
                    class="flex items-center gap-3 p-2 rounded-2xl bg-surface-50 dark:bg-surface-800/50 border border-surface-100 dark:border-surface-700"
                  >
                    <p-colorPicker
                      [(ngModel)]="temaActual.colorSecundario"
                      styleClass="scale-110 ml-1"
                    ></p-colorPicker>
                    <input
                      pInputText
                      [(ngModel)]="temaActual.colorSecundario"
                      class="flex-1 bg-transparent border-0 font-mono text-surface-900 dark:text-surface-0 focus:ring-0"
                    />
                    <div
                      class="w-6 h-6 rounded-full border border-surface-200 dark:border-surface-600"
                      [style.background]="temaActual.colorSecundario"
                    ></div>
                  </div>
                </div>

                <!-- Accent -->
                <div class="space-y-2">
                  <label
                    class="text-xs font-bold text-surface-500 dark:text-surface-400 uppercase tracking-wider ml-1"
                    >Color Acento</label
                  >
                  <div
                    class="flex items-center gap-3 p-2 rounded-2xl bg-surface-50 dark:bg-surface-800/50 border border-surface-100 dark:border-surface-700"
                  >
                    <p-colorPicker
                      [(ngModel)]="temaActual.colorAcento"
                      styleClass="scale-110 ml-1"
                    ></p-colorPicker>
                    <input
                      pInputText
                      [(ngModel)]="temaActual.colorAcento"
                      class="flex-1 bg-transparent border-0 font-mono text-surface-900 dark:text-surface-0 focus:ring-0"
                    />
                    <div
                      class="w-6 h-6 rounded-full border border-surface-200 dark:border-surface-600"
                      [style.background]="temaActual.colorAcento"
                    ></div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Appearance -->
            <div
              class="bg-surface-0 dark:bg-surface-900 rounded-[2.5rem] p-8 border border-surface-200 dark:border-surface-800 shadow-sm"
            >
              <h4
                class="text-lg font-bold text-surface-900 dark:text-surface-0 mb-6 flex items-center gap-2"
              >
                <span
                  class="w-8 h-8 rounded-lg bg-surface-100 dark:bg-surface-800 flex items-center justify-center text-surface-600 dark:text-surface-400"
                  ><i class="pi pi-moon"></i
                ></span>
                Apariencia
              </h4>

              <div
                class="flex items-center justify-between p-4 bg-surface-50 dark:bg-surface-800/50 rounded-2xl cursor-pointer hover:bg-surface-100 dark:hover:bg-surface-800 transition-colors"
                (click)="temaActual.esOscuro = !temaActual.esOscuro"
              >
                <div class="flex flex-col">
                  <span class="font-bold text-surface-900 dark:text-surface-0"
                    >Modo Oscuro</span
                  >
                  <span class="text-xs text-surface-500"
                    >Interfaz con alto contraste</span
                  >
                </div>
                <p-inputSwitch
                  [(ngModel)]="temaActual.esOscuro"
                ></p-inputSwitch>
              </div>
            </div>
          </div>

          <!-- Column 2: Live Preview -->
          <div class="xl:col-span-2">
            <div
              class="bg-surface-0 dark:bg-surface-900 rounded-[2.5rem] p-8 border border-surface-200 dark:border-surface-800 shadow-sm h-full flex flex-col"
            >
              <div class="flex justify-between items-center mb-6">
                <h4
                  class="text-lg font-bold text-surface-900 dark:text-surface-0 flex items-center gap-2"
                >
                  <span
                    class="w-8 h-8 rounded-lg bg-blue-100 dark:bg-blue-900/40 flex items-center justify-center text-blue-600 dark:text-blue-400"
                    ><i class="pi pi-eye"></i
                  ></span>
                  Vista Previa en Vivo
                </h4>
                <span
                  class="px-3 py-1 bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400 rounded-full text-xs font-bold uppercase tracking-wide"
                  >Live Preview</span
                >
              </div>

              <div
                class="flex-1 rounded-[2rem] overflow-hidden border-4 border-surface-100 dark:border-surface-800 shadow-inner relative transition-all duration-300"
                [style.background]="temaActual.esOscuro ? '#18181b' : '#ffffff'"
              >
                <!-- Fake App Window -->
                <!-- Header -->
                <div
                  class="h-16 px-6 flex items-center justify-between transition-colors duration-300"
                  [style.background]="
                    temaActual.esOscuro ? '#09090b' : '#ffffff'
                  "
                  [style.border-bottom]="
                    '1px solid ' + (temaActual.esOscuro ? '#27272a' : '#e4e4e7')
                  "
                >
                  <div
                    class="w-32 h-4 rounded-full bg-surface-200 dark:bg-surface-700"
                  ></div>
                  <div class="flex gap-2">
                    <div
                      class="w-8 h-8 rounded-full bg-surface-100 dark:bg-surface-800"
                    ></div>
                    <div
                      class="w-8 h-8 rounded-full bg-surface-100 dark:bg-surface-800"
                    ></div>
                  </div>
                </div>

                <!-- Body -->
                <div class="p-8">
                  <!-- Zen Card Preview -->
                  <div
                    class="rounded-[2rem] p-6 mb-6 border transition-all duration-300 shadow-sm"
                    [style.background]="
                      temaActual.esOscuro ? '#09090b' : '#ffffff'
                    "
                    [style.border-color]="
                      temaActual.esOscuro ? '#27272a' : '#e4e4e7'
                    "
                  >
                    <div class="flex items-center gap-3 mb-4">
                      <div
                        class="w-12 h-12 rounded-xl flex items-center justify-center text-white shadow-lg transition-colors duration-300"
                        [style.background]="temaActual.colorPrimario"
                      >
                        <i class="pi pi-bolt"></i>
                      </div>
                      <div>
                        <div
                          class="w-24 h-3 rounded-full mb-2 bg-surface-200 dark:bg-surface-700"
                        ></div>
                        <div
                          class="w-16 h-2 rounded-full bg-surface-100 dark:bg-surface-800"
                        ></div>
                      </div>
                    </div>

                    <div class="flex gap-3 mt-6">
                      <button
                        class="px-4 py-2 rounded-xl text-white text-sm font-bold shadow-lg transition-all active:scale-95 duration-300"
                        [style.background]="temaActual.colorPrimario"
                      >
                        Principal
                      </button>
                      <button
                        class="px-4 py-2 rounded-xl text-white text-sm font-bold shadow-lg transition-all active:scale-95 duration-300"
                        [style.background]="temaActual.colorSecundario"
                      >
                        Secundario
                      </button>
                    </div>
                  </div>

                  <!-- Progress Bar Preview -->
                  <div class="space-y-2 mb-6">
                    <div
                      class="flex justify-between text-xs font-bold"
                      [style.color]="
                        temaActual.esOscuro ? '#a1a1aa' : '#71717a'
                      "
                    >
                      <span>Progreso</span>
                      <span [style.color]="temaActual.colorAcento">75%</span>
                    </div>
                    <div
                      class="h-3 rounded-full overflow-hidden bg-surface-100 dark:bg-surface-800"
                    >
                      <div
                        class="h-full rounded-full transition-all duration-300 w-3/4"
                        [style.background]="temaActual.colorAcento"
                      ></div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- 5. üíæ BACKUP -->
      <section *ngSwitchCase="5" class="animate-fade-in-up">
        <!-- Header Section -->
        <div
          class="mb-8 p-6 bg-surface-0 dark:bg-surface-900 rounded-[2rem] border border-surface-200 dark:border-surface-800 shadow-sm flex flex-col md:flex-row md:items-center justify-between gap-4"
        >
          <div>
            <h3
              class="text-xl font-bold text-surface-900 dark:text-surface-0 tracking-tight flex items-center gap-2"
            >
              <i class="pi pi-database text-emerald-500"></i> Backup y
              Recuperaci√≥n
            </h3>
            <p class="text-surface-500 dark:text-surface-400 text-sm mt-1">
              Gestiona las copias de seguridad de tu informaci√≥n
            </p>
          </div>
          <p-tag
            [value]="
              configBackup.backupAutomatico ? 'Autom√°tico Activo' : 'Manual'
            "
            [severity]="configBackup.backupAutomatico ? 'success' : 'warning'"
            styleClass="px-3 py-1 text-sm font-bold rounded-lg"
          ></p-tag>
        </div>

        <div class="grid grid-cols-1 xl:grid-cols-3 gap-8">
          <!-- Column 1: Configuraci√≥n -->
          <div class="xl:col-span-1 space-y-6">
            <div
              class="bg-surface-0 dark:bg-surface-900 rounded-[2.5rem] p-8 border border-surface-200 dark:border-surface-800 shadow-sm"
            >
              <h4
                class="text-lg font-bold text-surface-900 dark:text-surface-0 mb-6 flex items-center gap-2"
              >
                <span
                  class="w-8 h-8 rounded-lg bg-emerald-100 dark:bg-emerald-900/40 flex items-center justify-center text-emerald-600 dark:text-emerald-400"
                  ><i class="pi pi-cog"></i
                ></span>
                Configuraci√≥n
              </h4>

              <div class="space-y-6">
                <!-- Backup Auto Switch -->
                <div
                  class="flex items-center justify-between p-4 bg-surface-50 dark:bg-surface-800/50 rounded-2xl border border-surface-100 dark:border-surface-700"
                >
                  <div class="flex flex-col">
                    <span class="font-bold text-surface-900 dark:text-surface-0"
                      >Respaldo Autom√°tico</span
                    >
                    <span class="text-xs text-surface-500"
                      >Programar copias diarias</span
                    >
                  </div>
                  <p-inputSwitch
                    [(ngModel)]="configBackup.backupAutomatico"
                  ></p-inputSwitch>
                </div>

                <div
                  *ngIf="configBackup.backupAutomatico"
                  class="space-y-4 animate-fade-in"
                >
                  <div class="space-y-2">
                    <label
                      class="text-xs font-bold text-surface-500 dark:text-surface-400 uppercase tracking-wider ml-1"
                      >Frecuencia</label
                    >
                    <p-dropdown
                      [options]="opcionesFrecuenciaBackup"
                      [(ngModel)]="configBackup.frecuenciaBackup"
                      optionLabel="label"
                      optionValue="value"
                      styleClass="w-full rounded-xl border-surface-200 dark:border-surface-700"
                    ></p-dropdown>
                  </div>

                  <div class="space-y-2">
                    <label
                      class="text-xs font-bold text-surface-500 dark:text-surface-400 uppercase tracking-wider ml-1"
                      >Hora Ejecuci√≥n</label
                    >
                    <input
                      type="time"
                      pInputText
                      [(ngModel)]="configBackup.horaBackup"
                      class="w-full p-3 bg-surface-50 dark:bg-surface-800 rounded-xl border border-surface-200 dark:border-surface-700"
                    />
                  </div>
                </div>

                <div class="space-y-2">
                  <label
                    class="text-xs font-bold text-surface-500 dark:text-surface-400 uppercase tracking-wider ml-1"
                    >Retenci√≥n (D√≠as)</label
                  >
                  <p-inputNumber
                    [(ngModel)]="configBackup.retencionDias"
                    [min]="1"
                    [max]="365"
                    suffix=" d√≠as"
                    styleClass="w-full"
                    inputStyleClass="w-full p-3 rounded-xl bg-surface-50 dark:bg-surface-800 border-surface-200 dark:border-surface-700"
                  ></p-inputNumber>
                </div>
              </div>
            </div>
          </div>

          <!-- Column 2: Estado y Acciones -->
          <div class="xl:col-span-2 space-y-6">
            <!-- Metrics Row -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
              <div
                class="bg-surface-0 dark:bg-surface-900 p-6 rounded-[2rem] border border-surface-200 dark:border-surface-800 flex items-center gap-4"
              >
                <div
                  class="w-12 h-12 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center text-green-600 dark:text-green-400"
                >
                  <i class="pi pi-check-circle text-xl"></i>
                </div>
                <div>
                  <p class="text-xs text-surface-500 uppercase font-bold">
                    √öltimo Backup
                  </p>
                  <p
                    class="text-sm font-bold text-surface-900 dark:text-surface-0"
                  >
                    Hoy, 02:00 AM
                  </p>
                </div>
              </div>
              <div
                class="bg-surface-0 dark:bg-surface-900 p-6 rounded-[2rem] border border-surface-200 dark:border-surface-800 flex items-center gap-4"
              >
                <div
                  class="w-12 h-12 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center text-blue-600 dark:text-blue-400"
                >
                  <i class="pi pi-database text-xl"></i>
                </div>
                <div>
                  <p class="text-xs text-surface-500 uppercase font-bold">
                    Tama√±o BD
                  </p>
                  <p
                    class="text-sm font-bold text-surface-900 dark:text-surface-0"
                  >
                    128.5 MB
                  </p>
                </div>
              </div>
              <div
                class="bg-surface-0 dark:bg-surface-900 p-6 rounded-[2rem] border border-surface-200 dark:border-surface-800 flex items-center gap-4"
              >
                <div
                  class="w-12 h-12 rounded-full bg-purple-100 dark:bg-purple-900/30 flex items-center justify-center text-purple-600 dark:text-purple-400"
                >
                  <i class="pi pi-server text-xl"></i>
                </div>
                <div>
                  <p class="text-xs text-surface-500 uppercase font-bold">
                    Espacio Libre
                  </p>
                  <p
                    class="text-sm font-bold text-surface-900 dark:text-surface-0"
                  >
                    45 GB
                  </p>
                </div>
              </div>
            </div>

            <!-- Actions Area -->
            <div
              class="bg-surface-0 dark:bg-surface-900 rounded-[2.5rem] p-8 border border-surface-200 dark:border-surface-800 shadow-sm relative overflow-hidden"
            >
              <div class="absolute top-0 right-0 p-8 opacity-5">
                <i
                  class="pi pi-save text-9xl text-surface-900 dark:text-surface-0"
                ></i>
              </div>

              <h4
                class="text-lg font-bold text-surface-900 dark:text-surface-0 mb-6 flex items-center gap-2 relative z-10"
              >
                <span
                  class="w-8 h-8 rounded-lg bg-indigo-100 dark:bg-indigo-900/40 flex items-center justify-center text-indigo-600 dark:text-indigo-400"
                  ><i class="pi pi-bolt"></i
                ></span>
                Acciones Manuales
              </h4>

              <div class="grid grid-cols-1 md:grid-cols-2 gap-4 relative z-10">
                <button
                  class="p-6 rounded-[2rem] bg-surface-50 dark:bg-surface-800 border border-surface-200 dark:border-surface-700 hover:bg-surface-100 dark:hover:bg-surface-700 transition-colors text-left group"
                  (click)="ejecutarBackupManual()"
                  [disabled]="backupEnProgreso"
                >
                  <div class="flex items-center justify-between mb-2">
                    <i
                      class="pi pi-download text-2xl text-primary-600 dark:text-primary-400 group-hover:scale-110 transition-transform"
                    ></i>
                    <i
                      *ngIf="backupEnProgreso"
                      class="pi pi-spin pi-spinner text-primary-500"
                    ></i>
                  </div>
                  <h5 class="font-bold text-surface-900 dark:text-surface-0">
                    Generar Backup Ahora
                  </h5>
                  <p class="text-xs text-surface-500 mt-1">
                    Descarga una copia completa de la base de datos localmente.
                  </p>
                </button>

                <button
                  class="p-6 rounded-[2rem] bg-surface-50 dark:bg-surface-800 border border-surface-200 dark:border-surface-700 hover:bg-surface-100 dark:hover:bg-surface-700 transition-colors text-left group"
                >
                  <div class="flex items-center justify-between mb-2">
                    <i
                      class="pi pi-upload text-2xl text-blue-600 dark:text-blue-400 group-hover:scale-110 transition-transform"
                    ></i>
                  </div>
                  <h5 class="font-bold text-surface-900 dark:text-surface-0">
                    Restaurar Copia
                  </h5>
                  <p class="text-xs text-surface-500 mt-1">
                    Importar un archivo de respaldo para restaurar datos.
                  </p>
                </button>
              </div>

              <!-- Progress Bar -->
              <div
                *ngIf="backupEnProgreso"
                class="mt-8 relative z-10 bg-surface-50 dark:bg-surface-800 p-4 rounded-2xl border border-surface-200 dark:border-surface-700 animate-fade-in"
              >
                <div class="flex justify-between items-center mb-2">
                  <span
                    class="text-sm font-bold text-primary-600 dark:text-primary-400"
                    >Procesando respaldo...</span
                  >
                  <span class="text-sm font-bold"
                    >{{ progresBackup | number: "1.0-0" }}%</span
                  >
                </div>
                <p-progressBar
                  [value]="progresBackup"
                  [showValue]="false"
                  styleClass="h-2"
                ></p-progressBar>
              </div>
            </div>
          </div>
        </div>
      </section>
    </div>
    <!-- End of ngSwitch -->
  </main>

  <!-- üó®Ô∏è DI√ÅLOGOS -->
  <p-confirmDialog styleClass="modern-confirm-dialog"></p-confirmDialog>
  <p-toast position="top-right" styleClass="modern-toast"></p-toast>

  <!-- üë§ DI√ÅLOGO USUARIO MODERNO -->
  <p-dialog
    [(visible)]="mostrarFormularioUsuario"
    [header]="usuarioSeleccionado ? 'Editar Usuario' : 'Nuevo Usuario'"
    [modal]="true"
    [style]="{ width: '650px' }"
    [closable]="true"
    styleClass="modern-dialog"
  >
    <div class="space-y-6">
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div class="space-y-2">
          <label
            for="nombre"
            class="flex items-center gap-2 text-sm font-medium text-surface-700 dark:text-surface-300"
          >
            <i class="pi pi-user text-blue-600 text-xs"></i>
            <span>Nombre Completo</span>
          </label>
          <input
            type="text"
            pInputText
            [(ngModel)]="nuevoUsuario.nombre"
            placeholder="Nombre completo"
            class="w-full rounded-2xl bg-surface-0 dark:bg-surface-900 border-surface-200 dark:border-surface-700"
          />
        </div>

        <div class="space-y-2">
          <label
            for="username"
            class="flex items-center gap-2 text-sm font-medium text-surface-700 dark:text-surface-300"
          >
            <i class="pi pi-at text-purple-600 text-xs"></i>
            <span>Username</span>
          </label>
          <input
            type="text"
            pInputText
            [(ngModel)]="nuevoUsuario.username"
            placeholder="usuario123"
            class="w-full rounded-2xl bg-surface-0 dark:bg-surface-900 border-surface-200 dark:border-surface-700"
          />
        </div>

        <div class="space-y-2">
          <label
            for="email"
            class="flex items-center gap-2 text-sm font-medium text-surface-700 dark:text-surface-300"
          >
            <i class="pi pi-envelope text-green-600 text-xs"></i>
            <span>Email</span>
          </label>
          <input
            type="email"
            pInputText
            [(ngModel)]="nuevoUsuario.email"
            placeholder="usuario@empresa.com"
            class="w-full rounded-2xl bg-surface-0 dark:bg-surface-900 border-surface-200 dark:border-surface-700"
          />
        </div>

        <div class="space-y-2">
          <label
            for="telefono"
            class="flex items-center gap-2 text-sm font-medium text-surface-700 dark:text-surface-300"
          >
            <i class="pi pi-phone text-orange-600 text-xs"></i>
            <span>Tel√©fono</span>
          </label>
          <input
            type="text"
            pInputText
            [(ngModel)]="nuevoUsuario.telefono"
            placeholder="+51 987 654 321"
            class="w-full rounded-2xl bg-surface-0 dark:bg-surface-900 border-surface-200 dark:border-surface-700"
          />
        </div>

        <div class="space-y-2">
          <label
            for="rol"
            class="flex items-center gap-2 text-sm font-medium text-surface-700 dark:text-surface-300"
          >
            <i class="pi pi-users text-indigo-600 text-xs"></i>
            <span>Rol</span>
          </label>
          <p-dropdown
            [(ngModel)]="nuevoUsuario.rol"
            [options]="opcionesRol"
            optionLabel="label"
            optionValue="value"
            placeholder="Seleccionar rol"
            styleClass="w-full"
          >
          </p-dropdown>
        </div>

        <div class="space-y-2">
          <label
            for="estado"
            class="flex items-center gap-2 text-sm font-medium text-surface-700 dark:text-surface-300"
          >
            <i class="pi pi-circle text-red-600 text-xs"></i>
            <span>Estado</span>
          </label>
          <p-dropdown
            [(ngModel)]="nuevoUsuario.estado"
            [options]="opcionesEstado"
            optionLabel="label"
            optionValue="value"
            placeholder="Seleccionar estado"
            styleClass="w-full"
          >
          </p-dropdown>
        </div>

        <div class="md:col-span-2 space-y-2">
          <label
            for="sucursal"
            class="flex items-center gap-2 text-sm font-medium text-surface-700 dark:text-surface-300"
          >
            <i class="pi pi-building text-teal-600 text-xs"></i>
            <span>Sucursal</span>
          </label>
          <input
            type="text"
            pInputText
            [(ngModel)]="nuevoUsuario.sucursal"
            placeholder="Principal"
            class="w-full rounded-2xl bg-surface-0 dark:bg-surface-900 border-surface-200 dark:border-surface-700"
          />
        </div>
      </div>
    </div>

    <ng-template pTemplate="footer">
      <div
        class="flex justify-end gap-3 pt-4 border-t border-surface-200 dark:border-surface-700"
      >
        <p-button
          icon="pi pi-times"
          label="Cancelar"
          [outlined]="true"
          severity="secondary"
          (click)="mostrarFormularioUsuario = false"
        >
        </p-button>
        <p-button
          icon="pi pi-check"
          [label]="usuarioSeleccionado ? 'Actualizar' : 'Crear Usuario'"
          severity="success"
          styleClass="shadow-md hover:shadow-lg transition-all"
          [loading]="guardando"
          (click)="guardarUsuario()"
        >
        </p-button>
      </div>
    </ng-template>
  </p-dialog>

  <!-- üñ®Ô∏è DI√ÅLOGO IMPRESORA OPTIMIZADO -->
  <p-dialog
    [(visible)]="mostrarFormularioImpresora"
    header="Configurar Nueva Impresora"
    [modal]="true"
    [style]="{ width: '600px' }"
    [closable]="true"
    styleClass="impresora-dialog"
  >
    <div class="impresora-form">
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div class="space-y-2">
          <label
            class="flex items-center gap-2 text-sm font-semibold text-surface-700 dark:text-surface-300"
          >
            <i class="pi pi-print text-purple-600"></i>
            <span>Nombre de la Impresora</span>
          </label>
          <input
            type="text"
            pInputText
            [(ngModel)]="nuevaImpresora.nombre"
            placeholder="Impresora Principal"
            class="w-full p-3 bg-surface-0 dark:bg-surface-900 border border-surface-200 dark:border-surface-700 rounded-2xl focus:border-primary-500 focus:ring-2 focus:ring-primary-100 transition-all duration-300 ease-out"
          />
        </div>

        <div class="space-y-2">
          <label
            class="flex items-center gap-2 text-sm font-semibold text-surface-700 dark:text-surface-300"
          >
            <i class="pi pi-map-marker text-green-600"></i>
            <span>Ubicaci√≥n</span>
          </label>
          <input
            type="text"
            pInputText
            [(ngModel)]="nuevaImpresora.ubicacion"
            placeholder="Caja Principal"
            class="w-full p-3 bg-surface-0 dark:bg-surface-900 border border-surface-200 dark:border-surface-700 rounded-2xl focus:border-primary-500 focus:ring-2 focus:ring-primary-100 transition-all duration-300 ease-out"
          />
        </div>

        <div class="space-y-2">
          <label
            class="flex items-center gap-2 text-sm font-semibold text-surface-700 dark:text-surface-300"
          >
            <i class="pi pi-cog text-blue-600"></i>
            <span>Tipo de Impresora</span>
          </label>
          <p-dropdown
            [(ngModel)]="nuevaImpresora.tipo"
            [options]="tiposImpresora"
            optionLabel="label"
            optionValue="value"
            placeholder="Seleccionar tipo"
            styleClass="w-full"
          >
          </p-dropdown>
        </div>

        <div class="space-y-2">
          <label
            class="flex items-center gap-2 text-sm font-semibold text-surface-700 dark:text-surface-300"
          >
            <i class="pi pi-file text-orange-600"></i>
            <span>Tama√±o de Papel</span>
          </label>
          <p-dropdown
            [(ngModel)]="nuevaImpresora.tamanoPapel"
            [options]="tamanosPapel"
            optionLabel="label"
            optionValue="value"
            placeholder="Seleccionar tama√±o"
            styleClass="w-full"
          >
          </p-dropdown>
        </div>

        <div class="space-y-2" *ngIf="nuevaImpresora.tipo === 'TERMICA'">
          <label
            class="flex items-center gap-2 text-sm font-semibold text-surface-700 dark:text-surface-300"
          >
            <i class="pi pi-wifi text-indigo-600"></i>
            <span>Direcci√≥n IP</span>
          </label>
          <input
            type="text"
            pInputText
            [(ngModel)]="nuevaImpresora.ip"
            placeholder="192.168.1.100"
            class="w-full p-3 bg-surface-0 dark:bg-surface-900 border border-surface-200 dark:border-surface-700 rounded-2xl focus:border-primary-500 focus:ring-2 focus:ring-primary-100 transition-all duration-300 ease-out"
          />
        </div>

        <div class="space-y-2" *ngIf="nuevaImpresora.tipo === 'TERMICA'">
          <label
            class="flex items-center gap-2 text-sm font-semibold text-surface-700 dark:text-surface-300"
          >
            <i class="pi pi-server text-teal-600"></i>
            <span>Puerto</span>
          </label>
          <p-inputNumber
            [(ngModel)]="nuevaImpresora.puerto"
            min="1"
            max="65535"
            placeholder="9100"
            inputStyleClass="p-3"
            styleClass="w-full"
          >
          </p-inputNumber>
        </div>
      </div>

      <div class="mt-6 space-y-3">
        <div class="bg-blue-50 p-4 rounded-lg border border-blue-200">
          <div class="flex items-center gap-3">
            <p-inputSwitch [(ngModel)]="nuevaImpresora.esDefault">
            </p-inputSwitch>
            <div>
              <label class="text-sm font-semibold text-blue-900 cursor-pointer">
                Establecer como impresora principal
              </label>
              <p class="text-xs text-blue-700">
                Esta impresora se usar√° por defecto
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <ng-template pTemplate="footer">
      <div
        class="flex justify-end gap-4 pt-4 border-t border-surface-200 dark:border-surface-700"
      >
        <p-button
          icon="pi pi-times"
          label="Cancelar"
          [outlined]="true"
          severity="secondary"
          (click)="mostrarFormularioImpresora = false"
        >
        </p-button>
        <p-button
          icon="pi pi-wifi"
          label="Probar Conexi√≥n"
          [outlined]="true"
          severity="info"
          [loading]="probandoConexion"
          (click)="probarConexionImpresora()"
        >
        </p-button>
        <p-button
          icon="pi pi-plus"
          label="Agregar Impresora"
          severity="success"
          styleClass="shadow-lg hover:shadow-xl transition-all duration-300"
          [loading]="guardando"
          (click)="guardarImpresora()"
        >
        </p-button>
      </div>
    </ng-template>
  </p-dialog>
</div>
