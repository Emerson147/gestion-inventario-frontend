<!-- SECTION: FINANCIAL & INVENTORY PULSE -->
<div class="grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-4 gap-4 mb-4">
  <!-- Utilidad Neta -->
  <app-zen-metric-card
    title="Utilidad Estimada"
    [value]="'S/ ' + ((kpisFinancieros.utilidadNeta | number: '1.0-0') || '0')"
    icon="pi-wallet"
    color="emerald"
    [trend]="0"
    trendLabel="vs costo"
    message="Margen: {{ kpisFinancieros.margenPromedio | number: '1.1-1' }}%"
  ></app-zen-metric-card>

  <!-- Valorización Inventario -->
  <app-zen-metric-card
    title="Valor de Inventario"
    [value]="
      'S/ ' + ((kpisInventario.valorizacionTotal | number: '1.0-0') || '0')
    "
    icon="pi-box"
    color="indigo"
    [trend]="0"
    trendLabel="Costo Total"
    message="{{ kpisInventario.itemsTotales | number }} items"
  ></app-zen-metric-card>

  <!-- Alertas de Stock -->
  <app-zen-metric-card
    title="Stock Crítico"
    [value]="(kpisInventario.stockBajoCount | number) || '0'"
    icon="pi-exclamation-triangle"
    color="rose"
    [trend]="0"
    trendLabel="Productos"
    message="Requieren atención"
  ></app-zen-metric-card>

  <!-- Margen Promedio (Visual) -->
  <div
    class="bg-white dark:bg-surface-900 rounded-[2rem] p-6 border border-surface-200 dark:border-surface-800 shadow-sm flex flex-col justify-center items-center relative overflow-hidden group transition-all duration-300 hover:shadow-lg hover:-translate-y-1"
  >
    <div
      class="absolute inset-0 bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-900/10 dark:to-indigo-900/10 opacity-0 group-hover:opacity-100 transition-opacity duration-500"
    ></div>

    <div class="relative z-10 text-center">
      <div
        class="w-12 h-12 rounded-2xl bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400 flex items-center justify-center mx-auto mb-3 group-hover:scale-110 transition-transform duration-300"
      >
        <i class="pi pi-percentage text-xl"></i>
      </div>
      <h3
        class="text-[10px] font-bold text-surface-500 dark:text-surface-400 uppercase tracking-widest mb-1"
      >
        Margen Global
      </h3>
      <div
        class="text-3xl font-black text-surface-900 dark:text-surface-0 tracking-tight"
      >
        {{ kpisFinancieros.margenPromedio | number: "1.1-1" }}%
      </div>
      <p class="text-xs text-surface-400 mt-1 font-medium">
        Rentabilidad promedio
      </p>
    </div>
  </div>
</div>

<!-- SECTION 1: OPERATIONAL KPIS -->
<div class="grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-4 gap-4">
  <app-zen-metric-card
    title="Ventas Totales"
    [value]="'S/ ' + ((kpis.ventasTotales | number: '1.0-0') || '0')"
    icon="pi-dollar"
    color="emerald"
    [trend]="kpis.crecimientoVentas || 0"
    trendIcon="pi-arrow-up"
    trendLabel="vs mes anterior"
  ></app-zen-metric-card>

  <app-zen-metric-card
    title="Transacciones"
    [value]="(kpis.numeroTransacciones | number) || '0'"
    icon="pi-shopping-bag"
    color="blue"
    [trend]="kpis.crecimientoTransacciones || 0"
    trendIcon="pi-arrow-up"
  ></app-zen-metric-card>

  <app-zen-metric-card
    title="Clientes Únicos"
    [value]="(kpis.clientesUnicos | number) || '0'"
    icon="pi-users"
    color="orange"
    [trend]="kpis.crecimientoClientes || 0"
    trendIcon="pi-arrow-up"
  ></app-zen-metric-card>

  <app-zen-metric-card
    title="Ticket Promedio"
    [value]="'S/ ' + ((kpis.ticketPromedio | number: '1.0-0') || '0')"
    icon="pi-receipt"
    color="purple"
    [trend]="kpis.crecimientoTicket || 0"
    trendIcon="pi-arrow-up"
  ></app-zen-metric-card>
</div>
