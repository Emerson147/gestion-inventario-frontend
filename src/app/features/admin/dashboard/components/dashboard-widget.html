<div *ngIf="loading" class="col-span-12 flex flex-col items-center justify-center py-20 animate-fade-in">
  <div class="relative w-16 h-16">
      <div class="absolute inset-0 rounded-full border-4 border-surface-100 dark:border-surface-800"></div>
      <div class="absolute inset-0 rounded-full border-4 border-indigo-500 border-t-transparent animate-spin"></div>
  </div>
  <span class="mt-4 text-sm font-bold text-surface-500 uppercase tracking-widest">Sincronizando Métricas...</span>
</div>

<div *ngIf="error && !loading" class="col-span-12 animate-fade-in">
  <div class="bg-red-50 dark:bg-red-900/10 border border-red-100 dark:border-red-900/30 rounded-2xl p-6 flex items-center gap-4 text-red-600 dark:text-red-400">
    <div class="w-10 h-10 rounded-full bg-red-100 dark:bg-red-900/30 flex items-center justify-center flex-shrink-0">
        <i class="pi pi-exclamation-triangle"></i>
    </div>
    <div>
      <h3 class="font-bold text-lg m-0">No se pudieron cargar los datos</h3>
      <p class="text-sm opacity-80 m-0">{{ error }}</p>
    </div>
  </div>
</div>

<ng-container *ngIf="!loading && !error">
  
  <div class="col-span-12 md:col-span-6 xl:col-span-4">
    <div class="group h-full bg-white dark:bg-surface-900 rounded-[2rem] p-6 border border-surface-200 dark:border-surface-800 hover:border-emerald-200 dark:hover:border-emerald-900/50 shadow-sm hover:shadow-lg transition-all duration-300 relative overflow-hidden cursor-pointer"
         [routerLink]="['/pages/producto']">
      
      <div class="relative z-10 flex flex-col justify-between h-full">
        <div class="flex justify-between items-start mb-4">
            <div>
                <span class="text-[10px] font-bold text-surface-400 uppercase tracking-widest block mb-1">Catálogo</span>
                <div class="text-4xl font-bold text-surface-900 dark:text-surface-0 tracking-tight transition-colors group-hover:text-emerald-600">
                    {{ data.category }}
                </div>
            </div>
            <div class="w-12 h-12 rounded-2xl bg-emerald-50 dark:bg-emerald-900/20 text-emerald-600 dark:text-emerald-400 flex items-center justify-center transition-transform group-hover:scale-110">
                <i class="pi pi-tags text-xl"></i>
            </div>
        </div>
        
        <div class="flex items-end justify-between">
            <div class="flex items-center gap-2">
                <span class="px-2 py-1 rounded-lg bg-emerald-50 dark:bg-emerald-900/20 text-emerald-700 dark:text-emerald-400 text-xs font-bold flex items-center gap-1">
                    <i class="pi pi-arrow-up text-[10px]"></i> {{ metrics?.crecimientoMensual | number:'1.1-1' }}%
                </span>
                <span class="text-xs text-surface-400 font-medium">vs mes anterior</span>
            </div>
            <i class="pi pi-arrow-right text-surface-300 group-hover:text-emerald-500 transition-colors group-hover:translate-x-1"></i>
        </div>
      </div>
    </div>
  </div>

  <div class="col-span-12 md:col-span-6 xl:col-span-4">
    <div class="group h-full bg-white dark:bg-surface-900 rounded-[2rem] p-6 border border-surface-200 dark:border-surface-800 hover:border-indigo-200 dark:hover:border-indigo-900/50 shadow-sm hover:shadow-lg transition-all duration-300 relative overflow-hidden cursor-pointer"
         [routerLink]="['/pages/producto']">
      
      <div class="relative z-10 flex flex-col justify-between h-full">
        <div class="flex justify-between items-start mb-4">
            <div>
                <span class="text-[10px] font-bold text-surface-400 uppercase tracking-widest block mb-1">Inventario Total</span>
                <div class="text-4xl font-bold text-surface-900 dark:text-surface-0 tracking-tight transition-colors group-hover:text-indigo-600">
                    {{ data.product }}
                </div>
            </div>
            <div class="w-12 h-12 rounded-2xl bg-indigo-50 dark:bg-indigo-900/20 text-indigo-600 dark:text-indigo-400 flex items-center justify-center transition-transform group-hover:scale-110">
                <i class="pi pi-box text-xl"></i>
            </div>
        </div>
        
        <div class="flex items-end justify-between">
            <div class="flex items-center gap-2">
                <span class="px-2 py-1 rounded-lg bg-orange-50 dark:bg-orange-900/20 text-orange-700 dark:text-orange-400 text-xs font-bold flex items-center gap-1"
                      [class.opacity-50]="!metrics?.productosStockCritico">
                    <i class="pi pi-exclamation-circle text-[10px]"></i> {{ metrics?.productosStockCritico || 0 }}
                </span>
                <span class="text-xs text-surface-400 font-medium">Stock Crítico</span>
            </div>
            <i class="pi pi-arrow-right text-surface-300 group-hover:text-indigo-500 transition-colors group-hover:translate-x-1"></i>
        </div>
      </div>
    </div>
  </div>

  <div class="col-span-12 md:col-span-6 xl:col-span-4">
    <div class="group h-full bg-white dark:bg-surface-900 rounded-[2rem] p-6 border border-surface-200 dark:border-surface-800 hover:border-rose-200 dark:hover:border-rose-900/50 shadow-sm hover:shadow-lg transition-all duration-300 relative overflow-hidden cursor-pointer"
         [routerLink]="['/pages/realizar-venta']">
      
      <div class="relative z-10 flex flex-col justify-between h-full">
        <div class="flex justify-between items-start mb-4">
            <div>
                <span class="text-[10px] font-bold text-surface-400 uppercase tracking-widest block mb-1">Transacciones Hoy</span>
                <div class="text-4xl font-bold text-surface-900 dark:text-surface-0 tracking-tight transition-colors group-hover:text-rose-600">
                    {{ data.bill }}
                </div>
            </div>
            <div class="w-12 h-12 rounded-2xl bg-rose-50 dark:bg-rose-900/20 text-rose-600 dark:text-rose-400 flex items-center justify-center transition-transform group-hover:scale-110">
                <i class="pi pi-shopping-cart text-xl"></i>
            </div>
        </div>
        
        <div class="flex items-end justify-between">
            <div class="flex items-center gap-2">
                <span class="px-2 py-1 rounded-lg bg-surface-100 dark:bg-surface-800 text-surface-700 dark:text-surface-200 text-xs font-bold font-mono">
                    S/. {{ metrics?.ventasTotalesHoy | number:'1.2-2' }}
                </span>
                <span class="text-xs text-surface-400 font-medium">Ingresos</span>
            </div>
            <i class="pi pi-arrow-right text-surface-300 group-hover:text-rose-500 transition-colors group-hover:translate-x-1"></i>
        </div>
      </div>
    </div>
  </div>

  <div class="col-span-12 md:col-span-6 xl:col-span-4">
    <div class="group h-full bg-white dark:bg-surface-900 rounded-[2rem] p-6 border border-surface-200 dark:border-surface-700 hover:border-blue-200 shadow-sm hover:shadow-lg transition-all duration-300 relative overflow-hidden cursor-pointer"
         [routerLink]="['/pages/almacen']">
      
      <div class="relative z-10 flex flex-col justify-between h-full">
        <div class="flex justify-between items-start mb-4">
            <div>
                <span class="text-[10px] font-bold text-surface-400 uppercase tracking-widest block mb-1">Logística</span>
                <div class="text-4xl font-bold text-surface-900 dark:text-surface-0 tracking-tight transition-colors group-hover:text-blue-600">
                    {{ data.warehouse }}
                </div>
            </div>
            <div class="w-12 h-12 rounded-2xl bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400 flex items-center justify-center transition-transform group-hover:scale-110">
                <i class="pi pi-building text-xl"></i>
            </div>
        </div>
        
        <div class="flex items-end justify-between">
            <div class="flex items-center gap-2">
                <span class="px-2 py-1 rounded-lg bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-400 text-xs font-bold font-mono">
                    S/. {{ metrics?.valorTotalInventario | number:'1.0-0' }}
                </span>
                <span class="text-xs text-surface-400 font-medium">Valorizado</span>
            </div>
            <i class="pi pi-arrow-right text-surface-300 group-hover:text-blue-500 transition-colors group-hover:translate-x-1"></i>
        </div>
      </div>
    </div>
  </div>

  <div class="col-span-12 md:col-span-6 xl:col-span-4">
    <div class="group h-full bg-white dark:bg-surface-900 rounded-[2rem] p-6 border border-surface-200 dark:border-surface-700 hover:border-purple-200 shadow-sm hover:shadow-lg transition-all duration-300 relative overflow-hidden cursor-pointer"
         [routerLink]="['/pages/usuario']">
      
      <div class="relative z-10 flex flex-col justify-between h-full">
        <div class="flex justify-between items-start mb-4">
            <div>
                <span class="text-[10px] font-bold text-surface-400 uppercase tracking-widest block mb-1">Equipo</span>
                <div class="text-4xl font-bold text-surface-900 dark:text-surface-0 tracking-tight transition-colors group-hover:text-purple-600">
                    {{ data.users }}
                </div>
            </div>
            <div class="w-12 h-12 rounded-2xl bg-purple-50 dark:bg-purple-900/20 text-purple-600 dark:text-purple-400 flex items-center justify-center transition-transform group-hover:scale-110">
                <i class="pi pi-users text-xl"></i>
            </div>
        </div>
        
        <div class="flex items-end justify-between">
            <div class="flex items-center gap-2">
                <span class="px-2 py-1 rounded-lg bg-emerald-50 dark:bg-emerald-900/20 text-emerald-700 dark:text-emerald-400 text-xs font-bold flex items-center gap-1">
                    <i class="pi pi-plus text-[10px]"></i> {{ metrics?.usuariosNuevos || 0 }}
                </span>
                <span class="text-xs text-surface-400 font-medium">Nuevos (Mes)</span>
            </div>
            <i class="pi pi-arrow-right text-surface-300 group-hover:text-purple-500 transition-colors group-hover:translate-x-1"></i>
        </div>
      </div>
    </div>
  </div>

  <div class="col-span-12 md:col-span-6 xl:col-span-4">
    <div class="group h-full bg-white dark:bg-surface-900 rounded-[2rem] p-6 border border-surface-200 dark:border-surface-700 hover:border-amber-200 shadow-sm hover:shadow-lg transition-all duration-300 relative overflow-hidden cursor-pointer"
         [routerLink]="['/pages/realizar-venta']">
      
      <div class="relative z-10 flex flex-col justify-between h-full">
        <div class="flex justify-between items-start mb-4">
            <div>
                <span class="text-[10px] font-bold text-surface-400 uppercase tracking-widest block mb-1">Ticket Medio</span>
                <div class="text-4xl font-bold text-surface-900 dark:text-surface-0 tracking-tight font-mono transition-colors group-hover:text-amber-600">
                    S/.{{ metrics?.ticketPromedio | number:'1.0-0' }}
                </div>
            </div>
            <div class="w-12 h-12 rounded-2xl bg-amber-50 dark:bg-amber-900/20 text-amber-600 dark:text-amber-400 flex items-center justify-center transition-transform group-hover:scale-110">
                <i class="pi pi-wallet text-xl"></i>
            </div>
        </div>
        
        <div class="flex items-end justify-between">
            <div class="flex items-center gap-2">
                <span class="px-2 py-1 rounded-lg bg-surface-100 dark:bg-surface-800 text-surface-700 dark:text-surface-200 text-xs font-bold font-mono">
                    S/. {{ metrics?.ventasTotalesMes | number:'1.0-0' }}
                </span>
                <span class="text-xs text-surface-400 font-medium">Mes actual</span>
            </div>
            <i class="pi pi-arrow-right text-surface-300 group-hover:text-amber-500 transition-colors group-hover:translate-x-1"></i>
        </div>
      </div>
    </div>
  </div>

</ng-container>