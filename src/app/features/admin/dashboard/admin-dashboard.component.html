<!-- Header Premium del Dashboard -->
<div class="mb-8">
  <div class="bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 rounded-3xl p-8 shadow-2xl relative overflow-hidden">
    <!-- Efecto de brillo animado -->
    <div class="absolute inset-0 bg-gradient-to-r from-white/0 via-white/20 to-white/0 animate-shimmer"></div>
    
    <div class="relative z-10">
      <div class="flex flex-col lg:flex-row lg:justify-between lg:items-center gap-4">
        <!-- Título principal -->
        <div>
          <div class="flex items-center gap-4 mb-3">
            <div class="bg-white/20 backdrop-blur-lg p-4 rounded-2xl shadow-lg">
              <i class="pi pi-chart-line text-white text-4xl"></i>
            </div>
            <div>
              <h1 class="text-4xl font-black text-white m-0 drop-shadow-lg">Dashboard Ejecutivo</h1>
              <p class="text-white/90 mt-2 mb-0 text-lg">Panel de control inteligente del sistema</p>
            </div>
          </div>
        </div>
        
        <!-- Indicadores de estado -->
        <div class="flex gap-4">
          <div class="bg-white/10 backdrop-blur-lg rounded-2xl px-6 py-4 border border-white/20">
            <div class="flex items-center gap-3">
              <div class="w-3 h-3 bg-green-400 rounded-full animate-pulse shadow-lg shadow-green-400/50"></div>
              <div class="text-white">
                <div class="text-xs opacity-80">Sistema Activo</div>
                <div class="font-bold text-sm">En Línea</div>
              </div>
            </div>
          </div>
          
          <div class="bg-white/10 backdrop-blur-lg rounded-2xl px-6 py-4 border border-white/20">
            <div class="flex items-center gap-3">
              <i class="pi pi-clock text-white text-xl"></i>
              <div class="text-white">
                <div class="text-xs opacity-80">Última actualización</div>
                <div class="font-bold text-sm">{{ultimaActualizacion | date:'shortTime'}}</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- KPIs Principales en cards premium -->
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-6 mb-8" *ngIf="kpis.length > 0">
  <div *ngFor="let kpi of kpis; trackBy: trackByKpiId" 
       class="bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-lg hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 border border-gray-100 dark:border-gray-700 group cursor-pointer">
    <div class="flex items-start justify-between mb-4">
      <div class="p-3 rounded-xl shadow-md group-hover:scale-110 transition-transform duration-300"
           [style.background-color]="kpi.color + '20'">
        <i [class]="getIconClass(kpi.icon)" 
           [style.color]="kpi.color"
           class="text-2xl"></i>
      </div>
      <div class="flex items-center gap-1 text-sm font-semibold"
           [ngClass]="getTendenciaColor(kpi.tendencia)">
        <i [class]="getTendenciaIcon(kpi.tendencia)" class="text-xs"></i>
        <span>{{kpi.porcentajeCambio > 0 ? '+' : ''}}{{kpi.porcentajeCambio | number:'1.1-1'}}%</span>
      </div>
    </div>
    
    <div class="mb-2">
      <div class="text-gray-500 dark:text-gray-400 text-xs font-medium uppercase tracking-wide mb-2">
        {{kpi.titulo}}
      </div>
      <div class="text-3xl font-black text-gray-900 dark:text-white mb-1 group-hover:scale-105 transition-transform">
        {{formatearValor(kpi.valor, kpi.tipo)}}
      </div>
      <div class="text-xs text-gray-500 dark:text-gray-400 mt-2">
        {{kpi.descripcion}}
      </div>
    </div>
  </div>
</div>

<!-- Sección de widgets principales -->
<div class="grid grid-cols-12 gap-6">
  
  <!-- Métricas básicas (cards de contadores) -->
  <app-dashboard-widget class="contents"/>
  
  <!-- Estadísticas y widgets adicionales -->
  <!-- <div class="col-span-12 xl:col-span-6">
    <app-stats-widget />
  </div> -->
  
  <!-- <div class="col-span-12 xl:col-span-6">
    <app-recent-sales-widget />
  </div> -->
<!--   
  <div class="col-span-12 xl:col-span-6">
    <app-best-selling-widget />
  </div>
  
  <div class="col-span-12 xl:col-span-6">
    <app-revenue-stream-widget />
  </div> -->
  
  <!-- <div class="col-span-12">
    <app-notifications-widget />
  </div> -->
</div>

<!-- Footer del dashboard con información adicional -->
<div class="mt-8 p-6 bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-900 rounded-2xl border border-gray-200 dark:border-gray-700">
    <div class="flex flex-wrap items-center justify-between gap-4">
    <div class="flex items-center gap-4">
      <div class="flex items-center gap-2">
        <div class="w-2 h-2 bg-blue-500 rounded-full"></div>
        <span class="text-sm text-gray-600 dark:text-gray-400">Actualización manual disponible</span>
      </div>
      <div class="hidden lg:block w-px h-6 bg-gray-300 dark:bg-gray-600"></div>
      <div class="flex items-center gap-2">
        <i class="pi pi-database text-blue-500"></i>
        <span class="text-sm text-gray-600 dark:text-gray-400">{{kpis.length}} métricas activas</span>
      </div>
      <div class="hidden lg:block w-px h-6 bg-gray-300 dark:bg-gray-600"></div>
      <div class="flex items-center gap-2">
        <i class="pi pi-clock text-gray-500"></i>
        <span class="text-sm text-gray-600 dark:text-gray-400">Última actualización: {{ultimaActualizacion | date:'shortTime'}}</span>
      </div>
    </div>    <div class="flex items-center gap-3">
      <button 
        (click)="actualizarDatos()"
        [disabled]="loading"
        class="px-4 py-2 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 rounded-lg shadow-sm border border-gray-200 dark:border-gray-600 transition-all duration-300 flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-300 disabled:opacity-50 disabled:cursor-not-allowed">
        <i class="pi" [ngClass]="loading ? 'pi-spin pi-spinner' : 'pi-refresh'"></i>
        <span>{{loading ? 'Actualizando...' : 'Actualizar Ahora'}}</span>
      </button>
      
      <button class="px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg shadow-md transition-all duration-300 flex items-center gap-2 text-sm font-semibold text-white">
        <i class="pi pi-download"></i>
        <span>Exportar Reporte</span>
      </button>
    </div>
  </div>
</div>

<!-- Loading Overlay -->
<div *ngIf="loading" class="fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50">
  <div class="bg-white dark:bg-gray-800 rounded-2xl p-8 shadow-2xl flex flex-col items-center gap-4">
    <i class="pi pi-spin pi-spinner text-6xl text-blue-500"></i>
    <p class="text-lg font-semibold text-gray-700 dark:text-gray-300">Cargando datos del sistema...</p>
  </div>
</div>

<!-- Estilo para animación shimmer -->
<style>
@keyframes shimmer {
  0% { transform: translateX(-100%); }
  100% { transform: translateX(100%); }
}

.animate-shimmer {
  animation: shimmer 3s infinite;
}
</style> 